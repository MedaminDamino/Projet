@typeparam TItem
@using System.Security.Claims
@inject AuthenticationStateProvider AuthenticationStateProvider

@* <input type="text" class="form-control mb-3"
       placeholder="Search..."
       @bind="searchTerm" @bind:event="oninput" /> *@

<div class="table-responsive">
    <table class="table table-striped table-hover">
        <thead>
            <tr>
                @TableHeader
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            @if (FilteredItems?.Any() != true)
            {
                <tr><td colspan="100%">No data available</td></tr>
            }
            else
            {
                @foreach (var item in FilteredItems!)
                {
                    <tr>
                        @RowTemplate(item)
                        <td>
                            <button class="btn btn-sm btn-outline-primary me-2" @onclick="() => OnEdit.InvokeAsync(item)">Edit</button>
                            <AuthorizeView Roles="SuperAdmin">
                                <Authorized>
                                    <button class="btn btn-sm btn-outline-danger" @onclick="async () => { if (OnDelete.HasDelegate) await OnDelete.InvokeAsync(item); }">Delete</button>
                                </Authorized>
                            </AuthorizeView>
                        </td>
                    </tr>
                }
            }
        </tbody>
    </table>
</div>

@code {
    private string searchTerm = "";

    private IEnumerable<TItem> FilteredItems =>
        string.IsNullOrWhiteSpace(searchTerm)
            ? Items
            : Items.Where(item =>
                item?.ToString()?.Contains(searchTerm, StringComparison.OrdinalIgnoreCase) == true);

    [Parameter] public IEnumerable<TItem> Items { get; set; } = new List<TItem>();
    [Parameter] public RenderFragment TableHeader { get; set; } = null!;
    [Parameter] public RenderFragment<TItem> RowTemplate { get; set; } = null!;
    [Parameter] public EventCallback<TItem> OnEdit { get; set; }
    [Parameter] public EventCallback<TItem> OnDelete { get; set; }
}
@* <style>
.search-box {
    max-width: 300px;
}

.search-box input {
    border-radius: 8px;
    padding: 10px 14px;
    font-size: 0.95rem;
    transition: all 0.2s ease-in-out;
}

.search-box input:focus {
    border-color: #0d6efd;
    box-shadow: 0 0 4px rgba(13, 110, 253, 0.3);
}
</style> *@
