<div class="@WrapperClass"
     style="@SpinnerStyle"
     role="status"
     aria-live="polite"
     aria-busy="true">
    @if (ShowOverlayScrim)
    {
        <div class="loading-scrim"></div>
    }

    <div class="loading-core">
        <span class="loading-spinner" aria-hidden="true"></span>

        @if (ShowLabel && !string.IsNullOrWhiteSpace(Label))
        {
            <span class="loading-label">@Label</span>
        }
    </div>
</div>

@code {
    [Parameter] public bool Inline { get; set; }
    [Parameter] public bool FullScreen { get; set; }
    [Parameter] public bool BlockUi { get; set; }
    [Parameter] public bool DimBackground { get; set; } = true;
    [Parameter] public int Size { get; set; } = 56;
    [Parameter] public string? Label { get; set; } = "Loading...";
    [Parameter] public bool ShowLabel { get; set; } = true;
    [Parameter] public string? CssClass { get; set; }

    private string WrapperClass
    {
        get
        {
            var classes = new List<string>
            {
                "loading-shell",
                Inline ? "loading-inline" : "loading-centered"
            };

            if (FullScreen || BlockUi)
            {
                classes.Add("loading-overlay");
                classes.Add(FullScreen ? "loading-overlay-fullscreen" : "loading-overlay-local");

                if (DimBackground)
                {
                    classes.Add("loading-overlay-dimmed");
                }
            }

            if (!string.IsNullOrWhiteSpace(CssClass))
            {
                classes.Add(CssClass);
            }

            return string.Join(" ", classes);
        }
    }

    private string SpinnerStyle => $"--spinner-size: {Size}px;";
    private bool ShowOverlayScrim => DimBackground && (FullScreen || BlockUi);
}
